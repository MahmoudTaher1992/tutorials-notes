Table of Contents
Conventions Used in this Book ....................................................vii
About the Authors ...........................................................................ix
Foreword.............................................................................................x
Chapter 1 - SQL as a Second Language................................. 1
Thinking in SQL by Joe Celko ........................................................1
Chapter 2 - SQL View Internals.............................................7
SQL Views Transformed by Peter Gulutzan................................7
Syntax ..................................................................................................7
Cheerful Little Fact #1:................................................................8
Cheerful Little Fact #2:................................................................8
View Merge.........................................................................................9
Table1 .......................................................................................... 10
The Small Problem with View Merge ......................................... 12
Temporary Tables........................................................................... 13
Permanent Materialized Views ..................................................... 15
UNION ALL Views ...................................................................... 17
Alternatives to Views ..................................................................... 19
Tips ................................................................................................... 20
References........................................................................................ 21
Chapter 3 - SQL JOIN ......................................................... 24
Relational Division by Joe Celko ................................................. 24
Chapter 4 - SQL UNION..................................................... 28
Set Operations by Joe Celko......................................................... 28
Introduction..................................................................................... 28
Set Operations: Union ................................................................... 29
Chapter 5 - SQL NULL ....................................................... 34
Selection by Joe Celko ................................................................... 34
Introduction..................................................................................... 34
The Null of It All............................................................................ 34
iv SQL Database Programmers Handbook
Defining a Three-valued Logic..................................................... 36
Wonder Shorthands ....................................................................... 36
Chapter 6 - Specifying Time ................................................ 38
Killing Time by Joe Celko............................................................. 38
Timing is Everything...................................................................... 38
Specifying "Lawful Time" ............................................................. 40
Avoid Headaches with Preventive Maintenance ....................... 41
Chapter 7 - SQL TIMESTAMP datatype ............................ 42
Keeping Time by Joe Celko.......................................................... 42
Chapter 8 - Internals of the IDENTITY datatype Column. 46
The Ghost of Sequential Processing by Joe Celko.................... 46
Early SQL and Contiguous Storage............................................. 46
IDENTITY Crisis .......................................................................... 47
Chapter 9 - Keyword Search Queries ................................... 50
Keyword Searches by Joe Celko................................................... 50
Chapter 10 - The Cost of Calculated Columns..................... 54
Calculated Columns by Joe Celko................................................ 54
Introduction..................................................................................... 54
Triggers........................................................................................ 55
INSERT INTO Statement....................................................... 57
UPDATE the Table................................................................... 58
Use a VIEW................................................................................ 58
Chapter 11 - Graphs in SQL ................................................. 60
Path Finder by Joe Celko .............................................................. 60
Chapter 12 - Finding the Gap in a Range ............................ 66
Filling in the Gaps by Joe Celko .................................................. 66
Chapter 13 - SQL and the Web ............................................ 71
Web Databases by Joe Celko........................................................ 71
Chapter 14 - Avoiding SQL Injection................................... 76
Table of Contents v
SQL Injection Security Threats by John Paul Cook ................. 76
Creating a Test Application........................................................... 76
Understanding the Test Application............................................ 78
Understanding Dynamic SQL ...................................................... 79
The Altered Logic Threat.............................................................. 80
The Multiple Statement Threat .................................................... 81
Prevention Through Code ............................................................ 83
Prevention Through Stored Procedures ..................................... 84
Prevention Through Least Privileges .......................................... 85
Conclusion....................................................................................... 85
Chapter 15 - Preventing SQL Worms................................... 87
Preventing SQL Worms by John Paul Cook.............................. 87
Finding SQL Servers Including MSDE ...................................... 87
Identifying Versions ....................................................................... 90
SQL Security Tools ........................................................................ 92
Preventing Worms.......................................................................... 92
MSDE Issues................................................................................... 93
.NET SDK MSDE and Visual Studio .NET ............................. 94
Application Center 2000................................................................ 95
Deworming...................................................................................... 95
Baseline Security Analyzer............................................................. 95
Conclusion....................................................................................... 96
Chapter 16 - Basic SQL Tuning Hints................................. 97
SQL tuning by Donald K. Burleson............................................ 97
Index .................................................................................... 99
vi