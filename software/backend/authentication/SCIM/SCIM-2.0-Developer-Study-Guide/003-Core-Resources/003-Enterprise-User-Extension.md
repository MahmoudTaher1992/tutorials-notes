Based on **Part 3, Item 12** of your Table of Contents, here is a detailed explanation of the **Enterprise User Extension**.

---

# 12. Enterprise User Extension

In SCIM 2.0, the "Core" User schema covers identity attributes common to almost any web service (e.g., `userName`, `emails`, `name`). However, businesses often have specific requirements that don't fit into a generic user profile (like "Cost Center" or "Manager").

To solve this without forcing every implementation to create custom fields, SCIM provides a **Standardized Extension** specifically for business/corporate use cases.

## The Schema URN
To use these attributes, you must declare the specific schema namespace in your JSON payload.

**Schema URI:**
`urn:ietf:params:scim:schemas:extension:enterprise:2.0:User`

## Why is this separated from the Core User?
Not every user in a system is an employee. A system might hold customers, partners, or contractors. The *Core* schema holds the basics; the *Enterprise Extension* holds data specifically relevant to employment hierarchy and accounting.

---

## Detailed Attribute List

Here are the specific attributes defined in the Enterprise Extension (RFC 7643 Section 4.3):

### 1. `employeeNumber` (String)
A string identifier assigned to the user by the organization (e.g., "EMP-12345").
*   **Note:** This is distinct from the SCIM `id`. Generally, the `id` is generated by the Service Provider (the database primary key), whereas `employeeNumber` is generated by the HR system (the Client).
*   **Best Practice:** Although not strictly enforced by the protocol, this should be unique across the organization.

### 2. `costCenter` (String)
Identifies the name or code of the cost center associated with the user.
*   **Use Case:** Critical for automated software licensing and billing (e.g., "Charge this Adobe license to Cost Center 9002").

### 3. `organization` (String)
The top-level name of the organization to which the user belongs.
*   **Example:** "Acme Corp" (Useful in multi-tenant environments or holding companies).

### 4. `division` (String)
The broad category or subsidiary within the organization.
*   **Example:** "North America Sales" or "Consumer Electronics".

### 5. `department` (String)
The specific team or functional unit.
*   **Use Case:** This is the most commonly used attribute for **Dynamic Group memberships**. (e.g., "Automatically add everyone in the 'IT-Security' department to the 'VPN Access' group").

### 6. `manager` (Complex Type)
This links the user to their reporting manager. It is a "Reference" type, meaning it points to another SCIM Resource.

It contains the following sub-attributes:
*   **`value`**: The SCIM `id` of the manager's User resource.
*   **`$ref`**: The URI (API endpoint) to fetch the managerâ€™s full resource.
*   **`displayName`**: The manager's full name (read-only, used for display purposes).

---

## JSON Implementation Example

This is the most critical part for developers. You cannot simply put `department` at the root level of the JSON. It must be namespaced.

**Correct JSON Structure:**

```json
{
  "schemas": [
    "urn:ietf:params:scim:schemas:core:2.0:User",
    "urn:ietf:params:scim:schemas:extension:enterprise:2.0:User"
  ],
  "userName": "alice.smith",
  "name": {
    "givenName": "Alice",
    "familyName": "Smith"
  },
  "emails": [
    {
      "value": "alice@example.com",
      "type": "work",
      "primary": true
    }
  ],
  
  // THE ENTERPRISE EXTENSION BLOCK STARTS HERE
  "urn:ietf:params:scim:schemas:extension:enterprise:2.0:User": {
    "employeeNumber": "E1005",
    "costCenter": "IT-200",
    "organization": "Acme Corp",
    "division": "Tech Ops",
    "department": "Security Team",
    "manager": {
      "value": "2819c223-7f76-453a-919d-413861904646",
      "$ref": "/Users/2819c223-7f76-453a-919d-413861904646",
      "displayName": "Bob Jones"
    }
  }
}
```

### Key Implementation Details:
1.  **Schema Declaration:** You **must** include the extension URI in the top-level `schemas` array. If you omit this, the server may ignore the enterprise data or throw an error.
2.  **Namespace Key:** The attributes must be nested inside a JSON object keyed by the Schema URI (`urn:ietf...`).
3.  **Manager Sequencing:** When provisioning users in bulk, you often encounter a "chicken and egg" problem with the `manager` attribute. You cannot assign a manager if the manager hasn't been created yet.
    *   *Solution:* Usually, systems perform a two-pass sync. Pass 1 creates all users. Pass 2 updates the users to add the `manager` links.

## Summary Table

| Attribute | Type | Mutability | Case Exact? | Required? |
| :--- | :--- | :--- | :--- | :--- |
| `employeeNumber` | String | readWrite | False | No |
| `costCenter` | String | readWrite | False | No |
| `organization` | String | readWrite | False | No |
| `division` | String | readWrite | False | No |
| `department` | String | readWrite | False | No |
| `manager` | Complex | readWrite | N/A | No |
